# PDF转图片预览使用指南

## 目录
- [功能概述](#功能概述)
- [快速开始](#快速开始)
- [参数说明](#参数说明)
- [使用场景](#使用场景)
- [常见问题](#常见问题)

## 功能概述

本Skill提供以下核心功能：

1. **PDF转图片**：将PDF文件的每一页转换为高质量图片
2. **HTML预览生成**：自动生成包含所有图片的HTML预览文件
3. **格式自定义**：支持PNG和JPG两种图片格式
4. **分辨率控制**：可调整图片DPI，平衡质量和文件大小

## 快速开始

### 基础使用

将PDF文件转换为PNG图片并生成预览：

```bash
python /workspace/projects/pdf-to-image-preview/scripts/pdf_to_images.py \
  --input ./document.pdf \
  --output-dir ./images \
  --html-output ./preview.html
```

### 高级选项

使用JPG格式和更高的分辨率：

```bash
python /workspace/projects/pdf-to-image-preview/scripts/pdf_to_images.py \
  --input ./document.pdf \
  --output-dir ./images \
  --html-output ./preview.html \
  --image-format jpg \
  --dpi 300
```

## 参数说明

### 必需参数

| 参数 | 说明 | 示例 |
|------|------|------|
| `--input` | 输入PDF文件路径 | `./report.pdf` |
| `--output-dir` | 图片输出目录 | `./images` |
| `--html-output` | HTML输出文件路径 | `./preview.html` |

### 可选参数

| 参数 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| `--image-format` | 图片格式 | `png`, `jpg` | `png` |
| `--dpi` | 图片分辨率 | 整数，建议150-300 | `200` |

## 使用场景

### 1. 文档预览
将PDF文档转换为在线可预览的HTML文件，方便用户在浏览器中查看。

### 2. 内容展示
将PDF内容嵌入网页或应用中，提供更好的用户体验。

### 3. 图片提取
从PDF中提取特定页面或所有页面的图片内容。

### 4. 移动端查看
将PDF转换为图片，更适合移动设备浏览。

## 常见问题

### Q1: 转换后的图片不清晰怎么办？

**A:** 提高 `--dpi` 参数的值，例如：
```bash
--dpi 300  # 生成更清晰的图片
```

### Q2: 生成的图片文件太大怎么办？

**A:** 降低DPI或使用JPG格式：
```bash
--image-format jpg --dpi 150  # 减小文件大小
```

### Q3: 支持哪些PDF版本？

**A:** 支持所有符合PDF标准的文档，包括PDF 1.0到PDF 2.0。

### Q4: 如何处理加密的PDF文件？

**A:** 当前版本不支持加密PDF。如需处理加密文档，请先解密。

### Q5: 生成的HTML文件可以在本地直接打开吗？

**A:** 可以。HTML文件包含相对路径引用，双击即可在浏览器中预览。

## 技术细节

### 图片格式对比

| 格式 | 优点 | 缺点 | 推荐场景 |
|------|------|------|----------|
| PNG | 无损压缩，支持透明度 | 文件较大 | 需要高质量输出 |
| JPG | 文件较小，兼容性好 | 有损压缩 | 网络传输，存储优化 |

### DPI建议值

| DPI | 效果 | 适用场景 |
|-----|------|----------|
| 72 | 网页显示 | 在线快速预览 |
| 150 | 标准质量 | 一般文档查看 |
| 200 | 高质量（默认） | 文档存档 |
| 300 | 印刷质量 | 打印、出版 |

## 输出文件结构

```
./
├── images/              # 图片输出目录
│   ├── page_001.png     # 第1页图片
│   ├── page_002.png     # 第2页图片
│   └── ...
└── preview.html         # HTML预览文件
```

## 性能参考

- 小型文档（<10页）：1-3秒
- 中型文档（10-50页）：5-15秒
- 大型文档（>50页）：20秒以上

*注：实际时间取决于文档复杂度和机器性能*
